{% extends 'base.html' %}
{% block title %}Minhas Ordens — Ordens de Serviço{% endblock %}
{% block content %}
<section class="card">
  <h1>Chamados abertos</h1>
  <table class="table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Cultivar</th>
        <th>Quantidade</th>
        <th>Observações</th>
        <th>Criada em</th>
      </tr>
    </thead>
    <tbody>
      {% if abertos and abertos|length > 0 %}
        {% for o in abertos %}
          <tr>
            <td>{{ o.id }}</td>
            <td>{{ o.cultivar.nome }}{% if o.cultivar.especie %} - {{ o.cultivar.especie }}{% endif %}</td>
            <td>{{ o.quantidade or '-' }}</td>
            <td>{{ o.descricao or '-' }}</td>
            <td>{{ o.created_at.strftime('%d/%m/%Y %H:%M') }}</td>
          </tr>
        {% endfor %}
      {% else %}
        <tr><td colspan="5">Nenhum chamado aberto.</td></tr>
      {% endif %}
    </tbody>
  </table>
</section>

<section class="card">
  <h2>Chamados finalizados</h2>
  <table class="table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Cultivar</th>
        <th>Quantidade</th>
        <th>Observações</th>
        <th>Criada em</th>
        <th>Finalizado em</th>
      </tr>
    </thead>
    <tbody>
      {% if finalizados and finalizados|length > 0 %}
        {% for o in finalizados %}
          <tr>
            <td>{{ o.id }}</td>
            <td>{{ o.cultivar.nome }}{% if o.cultivar.especie %} - {{ o.cultivar.especie }}{% endif %}</td>
            <td>{{ o.quantidade or '-' }}</td>
            <td>{{ o.descricao or '-' }}</td>
            <td>{{ o.created_at.strftime('%d/%m/%Y %H:%M') }}</td>
            <td>{{ o.data_finalizacao.strftime('%d/%m/%Y %H:%M') if o.data_finalizacao else '-' }}</td>
          </tr>
        {% endfor %}
      {% else %}
        <tr><td colspan="6">Nenhum chamado finalizado.</td></tr>
      {% endif %}
    </tbody>
  </table>
  <div class="form-actions">
    <a class="button" href="{{ url_for('ordens') }}">Abrir nova ordem</a>
  </div>
</section>
{% endblock %} 